var gmetzker;gmetzker=gmetzker||{};gmetzker.Observer=(function(){var c;c=function c(){if(!(this instanceof c)){return new c()}this._channelSubscribers={}};c.prototype.subscribe=function b(k,l,h){var j,i=this._channelSubscribers[k];if(a(i)){i=[]}if(a(h)){h=d(i)}j={priority:h,callback:l};i.push(j);i=i.sort(f);this._channelSubscribers[k]=i};c.prototype.unsubscribe=function g(k,l){var h,j=this._channelSubscribers[k];if(a(j)){return}for(h=0;h<j.length;h++){if(j[h].callback===l){j.splice(h,1);break}}if(j.length===0){delete this._channelSubscribers[k]}};c.prototype.publish=function e(m){var j,l,k,h=null;if((arguments.length===0)||a(m)){throw new Error("channelId argument required.")}if(arguments.length>1){h=Array.prototype.slice.call(arguments,1)}k=this._channelSubscribers[m];l={channelId:m,cancel:false};if(a(k)){return}for(j=0;j<k.length;j++){k[j].callback.apply(l,h);if(l.cancel){return false}}return true};function d(k){var j,h,l=0;if(a(k)){return l-1}h=k.length;for(j=0;j<h;j++){if((k[j].priority<0)&&(k[j].priority<l)){l=k[j].priority}}return l-1}function f(i,h){return h.priority-i.priority}function a(h){if(h===undefined){return true}if(h===null){return true}return false}return c}());